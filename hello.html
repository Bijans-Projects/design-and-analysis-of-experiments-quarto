<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bijan (Irshaad Adatia) 高雨山">
<meta name="dcterms.date" content="2026-02-06">

<title>Mathematical Statistics: Simulation and Computation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hello_files/libs/clipboard/clipboard.min.js"></script>
<script src="hello_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="hello_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="hello_files/libs/quarto-html/popper.min.js"></script>
<script src="hello_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hello_files/libs/quarto-html/anchor.min.js"></script>
<link href="hello_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hello_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hello_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hello_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hello_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<script src="hello_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="hello_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Mathematical Statistics: Simulation and Computation</h1>
            <p class="subtitle lead">A UPEI STAT 4240 Assignment</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><strong>Bijan</strong> (Irshaad Adatia) 高雨山 <a href="mailto:iadatia@upei.ca" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 6, 2026</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">Design and Analysis of Experiments and Observational Studies using R</div>
      <p>In Chapter 2, <em>Mathematical Statistics: Simulation and Computation</em>, we explore the foundational tools needed to work with data in the context of experimental and observational studies.</p>
      <p>This assignment focuses on using R to read, generate, and transform data, and to summarize and visualize key features of both discrete and continuous variables. Through computational examples and simulation, we examine how data structures, summaries, and graphical representations support statistical reasoning.</p>
      <p>By completing this chapter, we aim to develop practical skills in data manipulation, simulation, and interpretation, and to build an intuition for how sampling behavior and variability underpin later concepts in statistical inference.</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#setup-stuff" id="toc-setup-stuff" class="nav-link active" data-scroll-target="#setup-stuff">Setup Stuff</a></li>
  <li><a href="#randomization-exercise-2.3" id="toc-randomization-exercise-2.3" class="nav-link" data-scroll-target="#randomization-exercise-2.3">Randomization | Exercise 2.3</a></li>
  <li><a href="#exercise-2.4" id="toc-exercise-2.4" class="nav-link" data-scroll-target="#exercise-2.4">Exercise 2.4</a></li>
  <li><a href="#exercise-2.11" id="toc-exercise-2.11" class="nav-link" data-scroll-target="#exercise-2.11">Exercise 2.11</a></li>
  <li><a href="#exercise-2.12" id="toc-exercise-2.12" class="nav-link" data-scroll-target="#exercise-2.12">Exercise 2.12</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="setup-stuff" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="setup-stuff">Setup Stuff</h2>
<!-- 

## Meet the penguins fasjdkflafkla

The `penguins` data from the [**palmerpenguins**](https://allisonhorst.github.io/palmerpenguins) package contains size measurements for 344 penguins from three species observed on three islands in the Palmer Archipelago, Antarctica.

@fig-plot-penguins shows the relationship between flipper and bill lengths of these penguins.


::: {.cell}
::: {.cell-output-display}
![Flipper and bill length for penguins at Palmer Station LTER](hello_files/figure-html/fig-plot-penguins-1.png){#fig-plot-penguins width=672}
:::
:::

 -->
</section>
<section id="randomization-exercise-2.3" class="level2">
<h2 class="anchored" data-anchor-id="randomization-exercise-2.3">Randomization | Exercise 2.3</h2>
<div class="exercise-instructions">
<p>In Section 2.3, 20 patients for Example 2.5 were randomly selected from a population of 25,000.</p>
<ol type="a">
<li>Explain why the probability of choosing a random sample of 20 from 25,000 is <span class="math inline">\(\frac{1} {25000 \choose 20}\)</span></li>
<li>Use R to randomly select 4 patients from a total of 8 patients, and calculate the probability of choosing this random sample.</li>
</ol>
</div>
<section id="probability-exercise-2.3.a." class="level3">
<h3 class="anchored" data-anchor-id="probability-exercise-2.3.a.">Probability | Exercise 2.3.a.</h3>
<p>Explain why the probability of choosing a random sample of 20 from 25,000 is <span class="math inline">\(\frac{1} {25000 \choose 20}\)</span></p>
<p>Let’s start with smaller population size, 6, {A, B, C, D, E, F}. And, let’s start with a smaller sample size, 1. We can pick one of {A}, {B}, {C}, {D}, {E}, or {F}. That is, there are 6 ways to have a sample of size 1. The probability of choosing a random sample of size 1 from a population of size 6 is 1/6.</p>
<p>Let’s expand to a sample size 2. We know that once an individual is added to our sample, they can’t be picked again, and it doesn’t matter what order the individuals are added to the sample. Then, these are all the possible ways that we could pick them: {A, B} {A, C} {A, D} {A, E} {A, F}</p>
<p>{B, C} {B, D} {B, E} {B, F}</p>
<p>{C, D} {C, E} {C, F}</p>
<p>{D, E} {D, F}</p>
<p>{E, F}</p>
<p>That is, there are 15 ways to pick a sample of size 2. The probability of choosing a random sample of size 2 from a population of size 6 is 1/15.</p>
<p>We can recognize that the number of ways to pick a sample of size r from a population of size n is the binomial coefficient <span class="math inline">\(\frac{n!}{(r!(n-r)!)}\)</span> (i.e., “n choose r”).</p>
</section>
<section id="b.-use-r-to-randomly-select-4-patients-from-a-total-of-8-patients-and-calculate-the-probability-of-choosing-this-random-sample." class="level3">
<h3 class="anchored" data-anchor-id="b.-use-r-to-randomly-select-4-patients-from-a-total-of-8-patients-and-calculate-the-probability-of-choosing-this-random-sample.">b. Use R to randomly select 4 patients from a total of 8 patients, and calculate the probability of choosing this random sample.</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>populationSize <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sampleSize <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Patient Population</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>patients <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>populationSize)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Patient Sample</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>chosenRandomSample <span class="ot">&lt;-</span> patients <span class="sc">|&gt;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample_n</span>(sampleSize)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># How many random samples are possible?</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>numberOfRandomSamples <span class="ot">&lt;-</span> <span class="fu">choose</span>(populationSize, sampleSize)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of choosing this particular random sample</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>probabilityOfChosenRandomSample <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> numberOfRandomSamples)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="do">##################</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Output / Display</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>patients <span class="sc">|&gt;</span> </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">inSample =</span> <span class="fu">if_else</span>(id <span class="sc">%in%</span> chosenRandomSample<span class="sc">$</span>id, <span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">caption=</span><span class="st">"Patient Population"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Patient Population</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">inSample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>probabilityOfChosenRandomSample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01428571</code></pre>
</div>
</div>
<p>The probability of choosing this random sample is <span class="math inline">\(\frac{1}{70} \approx 0.014\)</span>.</p>
</section>
</section>
<section id="exercise-2.4" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2.4">Exercise 2.4</h2>
<p>The treatment assignment displayed in Table 2.5 is from one treatment assignment out of <span class="math inline">\({20 \choose 10}\)</span> possible random treatment assignments.</p>
<section id="a.-r-can-be-used-to-generate-all-possible-combinations-of-10-patients-assigned-to-the-treatment-group-using-combncovid_sampleid-10.-use-the-command-to-generate-the-combinations-and-confirm-that-there-are-20-choose-10-ways-to-generate-the-treatment-assignments." class="level3">
<h3 class="anchored" data-anchor-id="a.-r-can-be-used-to-generate-all-possible-combinations-of-10-patients-assigned-to-the-treatment-group-using-combncovid_sampleid-10.-use-the-command-to-generate-the-combinations-and-confirm-that-there-are-20-choose-10-ways-to-generate-the-treatment-assignments.">a. R can be used to generate all possible combinations of 10 patients assigned to the treatment group using <code>combn(covid_sample$id, 10)</code>. Use the command to generate the combinations and confirm that there are <span class="math inline">\({20 \choose 10}\)</span> ways to generate the treatment assignments.</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>covid_patientPopulationSize <span class="ot">=</span> <span class="dv">25000</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>covid_treatmentSampleSize <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>covid_activeTreatmentSampleSize <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># the number of patients to be assigned to the active treatment (i.e., no placebo)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">#################################</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The population of Covid Patients</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>covid_patientPopulation <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>covid_patientPopulationSize)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The sample of covid patients that we will treat</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>covid_treatmentSamplePatients <span class="ot">&lt;-</span> covid_patientPopulation <span class="sc">|&gt;</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample_n</span>(covid_treatmentSampleSize)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Of the sample of patients we will treat, every possible combination of those that will receive the active treatment</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>allPossibleActiveTreatmentSamplePatients <span class="ot">&lt;-</span> covid_treatmentSamplePatients<span class="sc">$</span>id <span class="sc">|&gt;</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combn</span>(covid_activeTreatmentSampleSize) <span class="sc">|&gt;</span> </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if
`.name_repair` is omitted as of tibble 2.0.0.
ℹ Using compatibility `.name_repair`.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>expectedActiveTreatmentSampleCombinationsSize <span class="ot">&lt;-</span> <span class="fu">choose</span>(covid_treatmentSampleSize, covid_activeTreatmentSampleSize)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">###########################</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>covid_treatmentSamplePatients <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>(<span class="at">caption=</span><span class="st">"COVID Patients to Receive Treatment Sample"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>COVID Patients to Receive Treatment Sample</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">16715</td>
</tr>
<tr class="even">
<td style="text-align: right;">17290</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20264</td>
</tr>
<tr class="even">
<td style="text-align: right;">14181</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10921</td>
</tr>
<tr class="even">
<td style="text-align: right;">4883</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16803</td>
</tr>
<tr class="even">
<td style="text-align: right;">19022</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16250</td>
</tr>
<tr class="even">
<td style="text-align: right;">18137</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1475</td>
</tr>
<tr class="even">
<td style="text-align: right;">9472</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15340</td>
</tr>
<tr class="even">
<td style="text-align: right;">8489</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13396</td>
</tr>
<tr class="even">
<td style="text-align: right;">20749</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17983</td>
</tr>
<tr class="even">
<td style="text-align: right;">14717</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15458</td>
</tr>
<tr class="even">
<td style="text-align: right;">18309</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(allPossibleActiveTreatmentSamplePatients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 184756</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>expectedActiveTreatmentSampleCombinationsSize</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 184756</code></pre>
</div>
</div>
</section>
<section id="b.-to-generate-the-random-array-of-treatment-assignments-in-table-2.5-r-was-used-to-randomly-select-10-patients-for-the-active-treatment-first-and-then-assigned-the-placebo-to-the-remaining-10.-we-can-also-generate-a-random-treatment-assignment-vector-by-randomly-selecting-a-column-from-the-matrix-of-all-possible-treatment-assignments-created-in-part-a.-in-r-randomly-select-a-column-and-assign-the-first-10-to-the-active-treatment-and-the-rest-to-the-placebo.-repeat-a-few-times-and-discuss-whether-the-procedure-results-in-random-assignments-as-desired.-hint-you-can-use-if_elsecondition-true-false-inside-mutate-to-return-true-when-condition-is-met-and-false-otherwise." class="level3">
<h3 class="anchored" data-anchor-id="b.-to-generate-the-random-array-of-treatment-assignments-in-table-2.5-r-was-used-to-randomly-select-10-patients-for-the-active-treatment-first-and-then-assigned-the-placebo-to-the-remaining-10.-we-can-also-generate-a-random-treatment-assignment-vector-by-randomly-selecting-a-column-from-the-matrix-of-all-possible-treatment-assignments-created-in-part-a.-in-r-randomly-select-a-column-and-assign-the-first-10-to-the-active-treatment-and-the-rest-to-the-placebo.-repeat-a-few-times-and-discuss-whether-the-procedure-results-in-random-assignments-as-desired.-hint-you-can-use-if_elsecondition-true-false-inside-mutate-to-return-true-when-condition-is-met-and-false-otherwise.">b. To generate the random array of treatment assignments in Table 2.5, R was used to randomly select 10 patients for the active treatment first and then assigned the placebo to the remaining 10. We can also generate a random treatment assignment vector by randomly selecting a column from the matrix of all possible treatment assignments created in part a. In R, randomly select a column and assign the first 10 to the active treatment and the rest to the placebo. Repeat a few times and discuss whether the procedure results in random assignments as desired. (Hint: You can use <code>if_else(condition, true, false)</code> inside <code>mutate</code> to return <code>true</code> when <code>condition</code> is met and <code>false</code> otherwise.)</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pick a random number between 1 and the total number of combinations to choose the patients that will get the active treatment</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>randomColumnNumberFrom_allPossibleActiveTreatmentSamplePatients <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(allPossibleActiveTreatmentSamplePatients),<span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all the patient IDs that will get the active treatment</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>covid_activeTreatmentSamplePatients <span class="ot">&lt;-</span> allPossibleActiveTreatmentSamplePatients <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(randomColumnNumberFrom_allPossibleActiveTreatmentSamplePatients)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="do">########################################</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>display <span class="ot">&lt;-</span> covid_treatmentSamplePatients <span class="sc">|&gt;</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">treatmentAssignment =</span> <span class="fu">if_else</span>(id <span class="sc">%in%</span> covid_activeTreatmentSamplePatients, <span class="st">"Active"</span>, <span class="st">"Placebo"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(treatmentAssignment, id)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">auto_index</span>(display<span class="sc">$</span>treatmentAssignment)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>display <span class="sc">|&gt;</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pack_rows</span>(<span class="at">index =</span> index) <span class="sc">|&gt;</span> </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">treatmentAssignment</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="10">
<td colspan="2" style="border-bottom: 1px solid"><strong>Active</strong></td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">13396</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">14181</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">15340</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">15458</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">16250</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">16803</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">17983</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">19022</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">20264</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">20749</td>
<td style="text-align: left;">Active</td>
</tr>
<tr class="even" data-grouplength="10">
<td colspan="2" style="border-bottom: 1px solid"><strong>Placebo</strong></td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">1475</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">4883</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">8489</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">9472</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">10921</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">14717</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">16715</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">17290</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">18137</td>
<td style="text-align: left;">Placebo</td>
</tr>
<tr class="even">
<td style="text-align: right; padding-left: 2em;" data-indentlevel="1">18309</td>
<td style="text-align: left;">Placebo</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Our first step uses a simple random sample of 20 patients from our population to receive treatment. Using this sample, we generate all possible combinations of choosing 10 patients. (i.e., <span class="math inline">\({20 \choose 10} = 184,756\)</span> possible combinations) Picking a random number from 1:184756 and giving those 10 patients the active treatment is still a simple random sample. We are always guaranteed to have exactly 20 randomly selected patients from the population, and exactly 10 of those will be randomly selected to receive the active treatment. This proceudre does result in random assignments as desired.</p>
</section>
<section id="c.-another-scheme-we-may-consider-is-to-assign-trt-or-pla-to-each-patient-with-equal-probabilities-independently.-implement-the-procedure-in-r.-repeat-a-few-times-and-discuss-whether-the-procedure-results-in-random-assignments-as-desired." class="level3">
<h3 class="anchored" data-anchor-id="c.-another-scheme-we-may-consider-is-to-assign-trt-or-pla-to-each-patient-with-equal-probabilities-independently.-implement-the-procedure-in-r.-repeat-a-few-times-and-discuss-whether-the-procedure-results-in-random-assignments-as-desired.">c.&nbsp;Another scheme we may consider is to assign <code>TRT</code> or <code>PLA</code> to each patient with equal probabilities independently. Implement the procedure in R. Repeat a few times and discuss whether the procedure results in random assignments as desired.</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "Equal Probability Assuming Independence"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>equalProbabilty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"TRT"</span>,<span class="st">"PLA"</span>), <span class="at">size =</span> covid_treatmentSampleSize, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign TRT or PLA to each patient independently</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>covid_treatmentSamplePatients <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">treatmentAssignment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"TRT"</span>,<span class="st">"PLA"</span>), <span class="at">size =</span> covid_treatmentSampleSize, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(treatmentAssignment) <span class="sc">|&gt;</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(treatmentAssignment) <span class="sc">|&gt;</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">treatmentAssignment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PLA</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRT</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">TODO</span><span class="do">: run a loop and document the distribution ... good to plot it as well. </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">trialTRT =</span> <span class="cn">NA</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (trial <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    currentTrial <span class="ot">&lt;-</span> covid_treatmentSamplePatients <span class="sc">|&gt;</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">treatmentAssignment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"TRT"</span>,<span class="st">"PLA"</span>), <span class="at">size =</span> covid_treatmentSampleSize, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(treatmentAssignment) <span class="sc">|&gt;</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(treatmentAssignment) <span class="sc">|&gt;</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>trialTRT[trial] <span class="ot">&lt;-</span> currentTrial<span class="sc">$</span>n[currentTrial<span class="sc">$</span>treatmentAssignment<span class="sc">==</span><span class="st">"TRT"</span>]</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>dict <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">TRT =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">0</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    currentValue <span class="ot">&lt;-</span> df[i,]<span class="sc">$</span>trialTRT</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    dict[dict<span class="sc">$</span>TRT<span class="sc">==</span>currentValue,]<span class="sc">$</span>n <span class="ot">&lt;-</span> dict[dict<span class="sc">$</span>TRT<span class="sc">==</span>currentValue,]<span class="sc">$</span>n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">TRT =</span> trialTRT) <span class="sc">|&gt;</span> </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(TRT) <span class="sc">|&gt;</span> </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
     TRT     n
   &lt;int&gt; &lt;int&gt;
 1     4     1
 2     5     1
 3     6     3
 4     7     8
 5     8    11
 6     9    20
 7    10    13
 8    11    16
 9    12    11
10    13     7
11    14     7
12    15     1
13    16     1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dict <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">factor</span>(TRT),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> n</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hello_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>TODO: We can see that while this does result in random assignments, it isn’t equally distributed.</p>
</section>
<section id="d.-can-you-think-of-another-procedure-in-r-for-randomly-assigning-10-patients-to-active-treatment-implement-your-own-procedure-in-r-to-verify-the-procedure-results-in-random-assignments." class="level3">
<h3 class="anchored" data-anchor-id="d.-can-you-think-of-another-procedure-in-r-for-randomly-assigning-10-patients-to-active-treatment-implement-your-own-procedure-in-r-to-verify-the-procedure-results-in-random-assignments.">d.&nbsp;Can you think of another procedure in R for randomly assigning 10 patients to active treatment? Implement your own procedure in R to verify the procedure results in random assignments.</h3>
<ul>
<li>Since the initial choosing of 20 names is already random, we could simply give the active treatment to the first 10 picked. (NOTE: This wouldn’t work if they were already ordered … would it?)</li>
<li>TODO: If patients are ordered by their ID, and we always choose the lowest 10 IDs, would it result in being random? duh, of course not.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>covid_treatmentSamplePatients <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(id) <span class="sc">|&gt;</span> <span class="do">### Obviously when this step is added, it won't be random.</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">treatmentAssignment =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>(id) <span class="sc">&lt;=</span> covid_activeTreatmentSampleSize, <span class="st">"TRT"</span>, <span class="st">"PLA"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
      id treatmentAssignment
   &lt;int&gt; &lt;chr&gt;              
 1  1475 TRT                
 2  4883 TRT                
 3  8489 TRT                
 4  9472 TRT                
 5 10921 TRT                
 6 13396 TRT                
 7 14181 TRT                
 8 14717 TRT                
 9 15340 TRT                
10 15458 TRT                
11 16250 PLA                
12 16715 PLA                
13 16803 PLA                
14 17290 PLA                
15 17983 PLA                
16 18137 PLA                
17 18309 PLA                
18 19022 PLA                
19 20264 PLA                
20 20749 PLA                </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>newDict <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="dv">0</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">0</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    this_covid_treatmentSamplePatients <span class="ot">&lt;-</span> covid_patientPopulation <span class="sc">|&gt;</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sample_n</span>(covid_treatmentSampleSize) <span class="sc">|&gt;</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(id) <span class="sc">|&gt;</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">treatmentAssignment =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>(id) <span class="sc">&lt;=</span> covid_activeTreatmentSampleSize, <span class="st">"TRT"</span>, <span class="st">"PLA"</span>))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="exercise-2.11" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2.11">Exercise 2.11</h2>
<p>A chemist has seven light objects to weigh on a balance pan scale. The standard deviation of each weighing is denoted by <span class="math inline">\(\sigma\)</span>. In a 1935 paper, Frank Yates suggested an improved technique by weighing all seven objects together, and also weighing them in groups of three. The groups are chosen so that each object is weighed four times altogether, twice with any other object and twice without it.</p>
<p>Let <span class="math inline">\(y_1,...,y_8\)</span> be the readings from the scale so that the equations for determining the unknown weights, <span class="math inline">\(\beta_1,...,\beta_7\)</span>, are</p>
<!-- Commented out because it's not in the textbook - but it's a nice way to visualize which beta_i's are in which y_i's
$$\begin{vmatrix}
    y_1 \\
    y_2 \\
    y_3 \\
    y_4 \\
    y_5 \\
    y_6 \\
    y_7 \\
    y_8  
\end{vmatrix}
=
\begin{vmatrix}
    \beta_1 & \beta_2 & \beta_3 & \beta_4 & \beta_5 & \beta_6 & \beta_7 & \epsilon_1 \\
    \beta_1 & \beta_2 & \beta_3 &         &         &         &         & \epsilon_2 \\
    \beta_1 &         &         & \beta_4 & \beta_5 &         &         & \epsilon_3 \\
    \beta_1 &         &         &         &         & \beta_6 & \beta_7 & \epsilon_4 \\
            & \beta_2 &         & \beta_4 &         & \beta_6 &         & \epsilon_5 \\
            & \beta_2 &         &         & \beta_5 &         & \beta_7 & \epsilon_6 \\
            &         & \beta_3 & \beta_4 &         &         & \beta_7 & \epsilon_7 \\
            &         & \beta_3 &         & \beta_5 & \beta_6 &         & \epsilon_8
\end{vmatrix}
$$ 
-->
<p><span class="math display">\[
\begin{align*}
y_1 &amp;= \beta_1 + \beta_2 + \beta_3 + \beta_4 + \beta_5 + \beta_6 + \beta_7 + \epsilon_1 \\
y_2 &amp;= \beta_1 + \beta_2 + \beta_3 + \epsilon_2 \\
y_3 &amp;= \beta_1 + \beta_4 + \beta_5 + \epsilon_3 \\
y_4 &amp;= \beta_1 + \beta_6 + \beta_7 + \epsilon_4 \\
y_5 &amp;= \beta_2 + \beta_4 + \beta_6 + \epsilon_5 \\
y_6 &amp;= \beta_2 + \beta_5 + \beta_7 + \epsilon_6 \\
y_7 &amp;= \beta_3 + \beta_4 + \beta_7 + \epsilon_7 \\
y_8 &amp;= \beta_3 + \beta_5 + \beta_6 + \epsilon_8
\end{align*}
\]</span></p>
<p>where the <span class="math inline">\(\epsilon_i,i=1,...,8\)</span> are independent errors.</p>
<p>Hotelling suggested modifying Yates’ procedure by placing in the other pan of the scale those of the objects not included in one of his weighings. In other words if the first three objects are to be weighed, then the remaining four objects would be placed in the opposite pan.</p>
<section id="a.-write-yates-procedure-in-matrix-form-and-find-the-least-squares-estimates-of-β." class="level3">
<h3 class="anchored" data-anchor-id="a.-write-yates-procedure-in-matrix-form-and-find-the-least-squares-estimates-of-β.">a. Write Yates’ procedure in matrix form and find the least squares estimates of β.</h3>
<p>Yates’ procedure can be written using the matrix form:</p>
<p><span class="math display">\[
y = X\beta + \epsilon
\]</span> <span class="math display">\[
\begin{pmatrix}
    y_1 \\ y_2 \\ y_3 \\ y_4 \\ y_5 \\ y_6 \\ y_7 \\ y_8
\end{pmatrix}
=
\begin{pmatrix}
    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    1 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\
    0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
    0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
    0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
    0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 0
\end{pmatrix}
\begin{pmatrix}
    \beta_1 \\ \beta_2 \\ \beta_3 \\ \beta_4 \\ \beta_5 \\ \beta_6 \\ \beta_7
\end{pmatrix}
+
\begin{pmatrix}
    \epsilon_1 \\ \epsilon_2 \\ \epsilon_3 \\ \epsilon_4 \\
    \epsilon_5 \\ \epsilon_6 \\ \epsilon_7 \\ \epsilon_8
\end{pmatrix}
\]</span></p>
<!-- 
$$
\overset{\vphantom{(n \times k)}}{y}_{(n \times 1)}
=
\overset{\vphantom{(n \times k)}}{X}_{(n \times k)}
\overset{\vphantom{(n \times k)}}{\beta}_{(k \times 1)}
+
\overset{\vphantom{(n \times k)}}{\epsilon}_{(n \times 1)}
$$

$$\begin{pmatrix}
    y_1 \\
    y_2 \\
    y_3 \\
    y_4 \\
    y_5 \\
    y_6 \\
    y_7 \\
    y_8
\end{pmatrix}
=
\begin{pmatrix}
    1 & 1 & 1 & 1 & 1 & 1 & 1 \\
    1 & 1 & 1 & 0 & 0 & 0 & 0 \\
    1 & 0 & 0 & 1 & 1 & 0 & 0 \\ 
    1 & 0 & 0 & 0 & 0 & 1 & 1 \\ 
    0 & 1 & 0 & 1 & 0 & 1 & 0 \\
    0 & 1 & 0 & 0 & 1 & 0 & 1 \\
    0 & 0 & 1 & 1 & 0 & 0 & 1 \\
    0 & 0 & 1 & 0 & 1 & 1 & 0
\end{pmatrix}
\begin{pmatrix}
    \beta_1 \\
    \beta_2 \\
    \beta_3 \\
    \beta_4 \\
    \beta_5 \\
    \beta_6 \\
    \beta_7
\end{pmatrix}
+
\begin{pmatrix}
    \epsilon_1 \\
    \epsilon_2 \\
    \epsilon_3 \\
    \epsilon_4 \\
    \epsilon_5 \\
    \epsilon_6 \\
    \epsilon_7 \\
    \epsilon_8
\end{pmatrix}
$$ 
-->
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Yates <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">8</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">7</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># X</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> Yates</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]    1    1    1    1    1    1    1
[2,]    1    1    1    0    0    0    0
[3,]    1    0    0    1    1    0    0
[4,]    1    0    0    0    0    1    1
[5,]    0    1    0    1    0    1    0
[6,]    0    1    0    0    1    0    1
[7,]    0    0    1    1    0    0    1
[8,]    0    0    1    0    1    1    0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X'X</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> X</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]    4    2    2    2    2    2    2
[2,]    2    4    2    2    2    2    2
[3,]    2    2    4    2    2    2    2
[4,]    2    2    2    4    2    2    2
[5,]    2    2    2    2    4    2    2
[6,]    2    2    2    2    2    4    2
[7,]    2    2    2    2    2    2    4</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (X'X)^-1</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">solve</span>(Y)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>W</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]
[1,]  0.4375 -0.0625 -0.0625 -0.0625 -0.0625 -0.0625 -0.0625
[2,] -0.0625  0.4375 -0.0625 -0.0625 -0.0625 -0.0625 -0.0625
[3,] -0.0625 -0.0625  0.4375 -0.0625 -0.0625 -0.0625 -0.0625
[4,] -0.0625 -0.0625 -0.0625  0.4375 -0.0625 -0.0625 -0.0625
[5,] -0.0625 -0.0625 -0.0625 -0.0625  0.4375 -0.0625 -0.0625
[6,] -0.0625 -0.0625 -0.0625 -0.0625 -0.0625  0.4375 -0.0625
[7,] -0.0625 -0.0625 -0.0625 -0.0625 -0.0625 -0.0625  0.4375</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (X'X)^-1 * X'</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> W <span class="sc">%*%</span> <span class="fu">t</span>(X)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]
[1,] 0.0625  0.3125  0.3125  0.3125 -0.1875 -0.1875 -0.1875 -0.1875
[2,] 0.0625  0.3125 -0.1875 -0.1875  0.3125  0.3125 -0.1875 -0.1875
[3,] 0.0625  0.3125 -0.1875 -0.1875 -0.1875 -0.1875  0.3125  0.3125
[4,] 0.0625 -0.1875  0.3125 -0.1875  0.3125 -0.1875  0.3125 -0.1875
[5,] 0.0625 -0.1875  0.3125 -0.1875 -0.1875  0.3125 -0.1875  0.3125
[6,] 0.0625 -0.1875 -0.1875  0.3125  0.3125 -0.1875 -0.1875  0.3125
[7,] 0.0625 -0.1875 -0.1875  0.3125 -0.1875  0.3125  0.3125 -0.1875</code></pre>
</div>
</div>
<p>Let <span class="math inline">\(X\)</span> be the <strong>design matrix</strong>, where each row <span class="math inline">\(i\)</span> corresponds to an individual instance of weighing, and where each column <span class="math inline">\(j\)</span> represents a “light object”.</p>
<p><span class="math display">\[
X = \begin{pmatrix}
    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    1 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\
    0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
    0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
    0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
    0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 0
\end{pmatrix}
\]</span></p>
<p>Then each entry in the design matrix is defined as</p>
<p><span class="math display">\[
x_{ij} = \begin{cases}
    1 &amp;\text{object } j \text{ is on the scale in weighing } i \\
    0 &amp;\text{otherwise}
\end{cases}
\]</span></p>
<p>Then, it follows that a column of <span class="math inline">\(X\)</span> is the <strong>participation pattern</strong> of one object across all weighings. For example Object 1 is in Weighing 1, 2, 3, and 4.</p>
<p>And so the <strong>normal matrix</strong> is:</p>
<p><span class="math display">\[
X^{T}X = \begin{pmatrix}
    4 &amp; 2 &amp; 2 &amp; 2 &amp; 2 &amp; 2 &amp; 2 \\
    2 &amp; 4 &amp; 2 &amp; 2 &amp; 2 &amp; 2 &amp; 2 \\
    2 &amp; 2 &amp; 4 &amp; 2 &amp; 2 &amp; 2 &amp; 2 \\
    2 &amp; 2 &amp; 2 &amp; 4 &amp; 2 &amp; 2 &amp; 2 \\
    2 &amp; 2 &amp; 2 &amp; 2 &amp; 4 &amp; 2 &amp; 2 \\
    2 &amp; 2 &amp; 2 &amp; 2 &amp; 2 &amp; 4 &amp; 2 \\
    2 &amp; 2 &amp; 2 &amp; 2 &amp; 2 &amp; 2 &amp; 4
\end{pmatrix}
\]</span></p>
<p>Which clearly results in each row <span class="math inline">\(j\)</span> and each column <span class="math inline">\(k\)</span> both representing an object, and the <span class="math inline">\((j,k)\)</span> entry is the number of weighings that include both objects as defined by:</p>
<p><span class="math display">\[
(X^{T}X)_{jk} = \sum_{i=1}^{8}x_{ij}x_{ik}
\]</span></p>
<p>It is clear to see that when <span class="math inline">\(j = k\)</span> the object has been in 4 weighings - this is true for every object. It is also clear to see that when <span class="math inline">\(j \not = k\)</span> that the objects are in exactly 2 weighings with each other - this is also true for every pair of objects.</p>
<p>Therefore, our interpretations are that:</p>
<ul>
<li>the diagonal represents how well each object is measured individually, and</li>
<li>the off-diagonal represents how entangled pairs of objects are</li>
</ul>
<p>We continue with the <strong>inverse normal matrix</strong>, which helps us better understand the unvertainty of the design.</p>
<p><span class="math display">\[
(X^\top X)^{-1}
=
\frac{1}{16}
\begin{pmatrix}
7 &amp; -1 &amp; -1 &amp; -1 &amp; -1 &amp; -1 &amp; -1 \\
-1 &amp;  7 &amp; -1 &amp; -1 &amp; -1 &amp; -1 &amp; -1 \\
-1 &amp; -1 &amp;  7 &amp; -1 &amp; -1 &amp; -1 &amp; -1 \\
-1 &amp; -1 &amp; -1 &amp;  7 &amp; -1 &amp; -1 &amp; -1 \\
-1 &amp; -1 &amp; -1 &amp; -1 &amp;  7 &amp; -1 &amp; -1 \\
-1 &amp; -1 &amp; -1 &amp; -1 &amp; -1 &amp;  7 &amp; -1 \\
-1 &amp; -1 &amp; -1 &amp; -1 &amp; -1 &amp; -1 &amp;  7
\end{pmatrix}
\]</span></p>
<p>As expected, we see symmetry and our interpretations are:</p>
<ul>
<li>the diagonal represents the noise of each individual objects; the higher the value the harder to estimate (i.e., relative variance)
<ul>
<li>“How much estimation uncertainty object j gets per unit of measurement noise”</li>
</ul></li>
<li>the off-diagonal represents the entanglement between objects and how uncertainty is shared</li>
</ul>
<p><span class="math display">\[
\text{Cov}(\hat{\beta}_j,\hat{\beta}_k) = -\frac{\sigma^2}{16}
\]</span></p>
<p>We then proceed to the <strong>least-squares operator</strong></p>
<p><span class="math display">\[
(X^\top X)^{-1}X^\top
=
\frac{1}{16}
\begin{pmatrix}
1 &amp; 5 &amp; 5 &amp; 5 &amp; -3 &amp; -3 &amp; -3 &amp; -3 \\
1 &amp; 5 &amp; -3 &amp; -3 &amp; 5 &amp; 5 &amp; -3 &amp; -3 \\
1 &amp; 5 &amp; -3 &amp; -3 &amp; -3 &amp; -3 &amp; 5 &amp; 5 \\
1 &amp; -3 &amp; 5 &amp; -3 &amp; 5 &amp; -3 &amp; 5 &amp; -3 \\
1 &amp; -3 &amp; 5 &amp; -3 &amp; -3 &amp; 5 &amp; -3 &amp; 5 \\
1 &amp; -3 &amp; -3 &amp; 5 &amp; 5 &amp; -3 &amp; -3 &amp; 5 \\
1 &amp; -3 &amp; -3 &amp; 5 &amp; -3 &amp; 5 &amp; 5 &amp; -3
\end{pmatrix}
\]</span></p>
<p>Which, when multiplied by <span class="math inline">\(\underset{n \times 1}{y}\)</span> gives us our least squares estimators:</p>
<!-- I prefer the factored version below :-)
$$
\hat{\beta}_1 =
\frac{1}{16} y_1
+ \frac{5}{16} y_2
+ \frac{5}{16} y_3
+ \frac{5}{16} y_4
- \frac{3}{16} y_5
- \frac{3}{16} y_6
- \frac{3}{16} y_7
- \frac{3}{16} y_8
$$
$$
\hat{\beta}_2 =
\frac{1}{16} y_1
+ \frac{5}{16} y_2
- \frac{3}{16} y_3
- \frac{3}{16} y_4
+ \frac{5}{16} y_5
+ \frac{5}{16} y_6
- \frac{3}{16} y_7
- \frac{3}{16} y_8
$$
$$
\hat{\beta}_3 =
\frac{1}{16} y_1
+ \frac{5}{16} y_2
- \frac{3}{16} y_3
- \frac{3}{16} y_4
- \frac{3}{16} y_5
- \frac{3}{16} y_6
+ \frac{5}{16} y_7
+ \frac{5}{16} y_8
$$
$$
\hat{\beta}_4 =
\frac{1}{16} y_1
- \frac{3}{16} y_2
+ \frac{5}{16} y_3
- \frac{3}{16} y_4
+ \frac{5}{16} y_5
- \frac{3}{16} y_6
+ \frac{5}{16} y_7
- \frac{3}{16} y_8
$$
$$
\hat{\beta}_5 =
\frac{1}{16} y_1
- \frac{3}{16} y_2
+ \frac{5}{16} y_3
- \frac{3}{16} y_4
- \frac{3}{16} y_5
+ \frac{5}{16} y_6
- \frac{3}{16} y_7
+ \frac{5}{16} y_8
$$
$$
\hat{\beta}_6 =
\frac{1}{16} y_1
- \frac{3}{16} y_2
- \frac{3}{16} y_3
+ \frac{5}{16} y_4
+ \frac{5}{16} y_5
- \frac{3}{16} y_6
- \frac{3}{16} y_7
+ \frac{5}{16} y_8
$$
$$
\hat{\beta}_7 =
\frac{1}{16} y_1
- \frac{3}{16} y_2
- \frac{3}{16} y_3
+ \frac{5}{16} y_4
- \frac{3}{16} y_5
+ \frac{5}{16} y_6
+ \frac{5}{16} y_7
- \frac{3}{16} y_8
$$ 
-->
<p><span class="math display">\[
\hat{\beta}_1
= \frac{1}{16}
\bigl(
y_1
+ 5y_2
+ 5y_3
+ 5y_4
- 3y_5
- 3y_6
- 3y_7
- 3y_8
\bigr)
\]</span> <span class="math display">\[
\hat{\beta}_2
= \frac{1}{16}
\bigl(
y_1
+ 5y_2
- 3y_3
- 3y_4
+ 5y_5
+ 5y_6
- 3y_7
- 3y_8
\bigr)
\]</span></p>
<p><span class="math display">\[
\hat{\beta}_3
= \frac{1}{16}
\bigl(
y_1
+ 5y_2
- 3y_3
- 3y_4
- 3y_5
- 3y_6
+ 5y_7
+ 5y_8
\bigr)
\]</span></p>
<p><span class="math display">\[
\hat{\beta}_4
= \frac{1}{16}
\bigl(
y_1
- 3y_2
+ 5y_3
- 3y_4
+ 5y_5
- 3y_6
+ 5y_7
- 3y_8
\bigr)
\]</span></p>
<p><span class="math display">\[
\hat{\beta}_5
= \frac{1}{16}
\bigl(
y_1
- 3y_2
+ 5y_3
- 3y_4
- 3y_5
+ 5y_6
- 3y_7
+ 5y_8
\bigr)
\]</span></p>
<p><span class="math display">\[
\hat{\beta}_6
= \frac{1}{16}
\bigl(
y_1
- 3y_2
- 3y_3
+ 5y_4
+ 5y_5
- 3y_6
- 3y_7
+ 5y_8
\bigr)
\]</span></p>
<p><span class="math display">\[
\hat{\beta}_7
= \frac{1}{16}
\bigl(
y_1
- 3y_2
- 3y_3
+ 5y_4
- 3y_5
+ 5y_6
+ 5y_7
- 3y_8
\bigr)
\]</span></p>
<div class="end-question">

</div>
</section>
<section id="b.-write-hotellings-procedure-in-matrix-form" class="level3">
<h3 class="anchored" data-anchor-id="b.-write-hotellings-procedure-in-matrix-form">b. Write Hotelling’s procedure in matrix form</h3>
<ol start="3" type="a">
<li>Find the variance of a weight using Yates’ and Hotelling’s procedures.</li>
<li>If the chemist wanted estimates of the weights with the highest precision, then which procedure (Yates or Hotelling) would you recommend that the chemist use to weigh objects? Explain your reasoning.</li>
</ol>
</section>
</section>
<section id="exercise-2.12" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2.12">Exercise 2.12</h2>
<p>Does life satisfaction change by region over time? Use the lifesat_childmort data from Example 2.15 to explore this question.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="hello_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>